/* =============================================================================
   LEGACY CSS - BEING PHASED OUT
   This file contains deprecated styles replaced by Tailwind CSS (via CDN).
   See layout.html for Tailwind config and new component implementations.
   ============================================================================= */

/* !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   ⛔ CRITICAL: NAVBAR STYLES FORBIDDEN HERE ⛔
   
   DO NOT add ANY navbar background, #main-navbar, or .navbar background styles!
   
   WHY: Navbar styles MUST live in layout.html's inline <style> block to:
   - Ensure !important precedence without cascade conflicts
   - Keep navbar UI separate from legacy CSS
   - Prevent the 7+ regressions we've had from CSS file loading order
   
   LOCATION: src/main/resources/templates/fragments/layout.html (lines 169-178)
   
   ALLOWED HERE: .navbar-brand, .navbar-toggler (non-background styling only)
   FORBIDDEN: Any #main-navbar styles, navbar background colors, navbar layout
   
   IF YOU NEED TO CHANGE NAVBAR:
   1. Edit layout.html's <style> block, NOT this file
   2. Do NOT add navbar background styles here
   3. Legacy .navbar-brand styles below are ONLY for logo, not background
   
   This guard exists because navbar background styles were repeatedly 
   overridden by CSS in this file, causing persistent visual regressions.
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! */

/* Base Styles - Minimal fallbacks for legacy pages */
body {
    font-family: var(--font-family-body);
    background-color: var(--bg-color);
    color: var(--text-color-primary);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    line-height: 1.6;
    margin: 0;
    padding-top: 0;
    border-top: 0;
}

/* @deprecated - Replaced by Tailwind navbar background
 * Old purple navbar gradient no longer used */
html {
    margin: 0;
    padding: 0;
    border: 0;
    overscroll-behavior-y: contain; /* Prevent bounce overscroll showing browser background */
}

/* @deprecated - Replaced by Tailwind navbar
 * Set HTML background to match navbar start color for each theme */
html:not([data-theme="dark"]) { /* Assumes light theme by default or when data-theme="light" */
    background-color: #FDFCFA; /* Light mode linen background */
}

html[data-theme="dark"] {
    background-color: #171A23; /* Dark mode obsidian background */
}

/* KEEP - Still used for fallback typography, but will be replaced incrementally */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-family-headings);
    margin-bottom: 1rem;
    font-weight: 700;
    color: var(--text-color-primary);
}

/* KEEP - Still used for fallback link styles */
a {
    color: var(--link-color);
    text-decoration: none;
    transition: all 0.3s ease;
}

a:hover {
    color: var(--link-hover-color);
}

/* @deprecated - Replaced by Tailwind utility classes
 * Layout */
.main-content {
    flex: 1;
    padding: 0;
}

/* @deprecated - Replaced by Tailwind container mx-auto px-4 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
}

/* @deprecated - Replaced by Tailwind section classes with explicit spacing */
section {
    margin-bottom: 3rem;
}


.navbar-brand {
    font-family: var(--font-family-headings);
    font-weight: 700;
    color: var(--text-color-accent);
    font-size: 1.5rem;
    padding: 0;
    display: flex;
    align-items: center;
    position: relative;
    z-index: 1001;
    cursor: pointer;
}

.navbar-brand img {
    height: 50px;
    width: auto;
    -webkit-user-drag: none;
    pointer-events: auto; /* Ensures clickability */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none; /* Cross-browser alternative to prevent selection */
    pointer-events: auto !important;
}

.navbar-brand,
.navbar-brand * {
    pointer-events: auto !important;
    -webkit-user-select: none;
    user-select: none;
}

.nav-link {
    color: var(--text-color-secondary);
    font-weight: 600;
    transition: color 0.3s;
    padding: 0.5rem 1rem;
    margin: 0 0.25rem;
    position: relative;
}

.nav-link:hover, .nav-link.active {
    color: var(--text-color-accent);
}

.nav-link.active:after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: currentColor;
    border-radius: 2px;
}

.navbar-toggler {
    border: none;
    padding: 0;
}

.navbar-toggler:focus {
    box-shadow: none;
}
/* END DEPRECATED NAVBAR STYLES */

/* =============================================================================
   @deprecated - FOOTER STYLES - FULLY REPLACED
   Old footer replaced with Tailwind in layout.html:331-355
   New: Clean minimal footer with flex layout
   ============================================================================= */
.footer {
    background-color: #080D14;
    padding: 1.5rem 0;
    margin-top: auto;
    box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.07);
}
/* END DEPRECATED FOOTER STYLES */





/* Badges */
/* Commenting out the problematic .badge.bg-light to avoid conflicts with the more specific .hero-section .badge styling */
/*
.badge.bg-light {
    background-color: var(--popular-tag-bg) !important;
    color: var(--popular-tag-text) !important;
    border: 1px solid var(--border-color);
}

.badge.bg-light:hover {
    background-color: var(--popular-tag-hover-bg) !important;
    color: var(--popular-tag-hover-text) !important;
}
*/

/* KEEP - Still used for ratings badges */
.badge.bg-warning {
    background-color: var(--warning-color) !important;
    color: var(--dark-color) !important;
}

/* =============================================================================
   KEEP - Book Details Page (not yet migrated to Tailwind)
   These styles are still active for book.html
   ============================================================================= */
.book-cover-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    width: 100%;
}

.book-cover-section {
    background-color: #f8f9fa;
    border-radius: 0.375rem 0 0 0.375rem;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    height: 100%;
}

.book-cover-section img.book-cover {
    max-height: 500px;
    max-width: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    border-radius: 5px;
}

.metadata-item {
    margin-bottom: 0.5rem;
}

.metadata-label {
    font-size: 0.875rem;
    color: var(--grey-500);
    margin-bottom: 0.25rem;
}

.metadata-value {
    font-weight: 600;
}

.description-text {
    line-height: 1.7;
}
/* END Book Details Page */

/* =============================================================================
   PARTIALLY DEPRECATED - Button Styles
   Some buttons still use Bootstrap classes (book details page)
   ============================================================================= */
.btn {
    border-radius: 8px;
    font-weight: 600;
    padding: 0.65rem 1.25rem;
    transition: all 0.2s ease-in-out;
    text-transform: none;
    letter-spacing: 0.02em;
}

.btn-primary {
    background-color: var(--button-primary-bg);
    border-color: var(--button-primary-bg);
    color: var(--button-primary-text);
}

.btn-primary:hover, .btn-primary:focus {
    background-color: var(--button-primary-hover-bg);
    border-color: var(--button-primary-hover-bg);
    color: var(--button-primary-text);
    box-shadow: 0 0 0 0.2rem var(--brand-primary-glow-color);
}

.btn-success {
    background-color: var(--success-color);
    border-color: var(--success-color);
}

.btn-outline-primary {
    color: var(--button-outline-primary-text);
    border-color: var(--button-outline-primary-border);
    background-color: transparent;
}

.btn-outline-primary:hover {
    color: var(--button-outline-primary-hover-text);
    background-color: var(--button-outline-primary-hover-bg);
    border-color: var(--button-outline-primary-border);
}

.btn-sm {
    padding: 0.25rem 1rem;
    font-size: 0.875rem;
}
/* END Button Styles */

/* =============================================================================
   KEEP - Search Results Page (not yet migrated)
   ============================================================================= */
.search-header {
    background-color: white;
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.list-view .book-cover {
    max-height: 200px;
    object-fit: cover;
}
/* END Search Results */

/* =============================================================================
   KEEP - Pagination (not yet migrated)
   ============================================================================= */
.pagination {
    display: inline-flex;
    background: rgba(255, 255, 255, 0.1);
    padding: 0.5rem;
    border-radius: 2rem;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.pagination .page-item .page-link {
    color: var(--dark-color);
    background-color: transparent;
    border: none;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    border-radius: 50%;
    margin: 0 0.25rem;
    padding: 0;
    transition: all 0.2s ease;
}

.pagination .page-item .page-link:hover {
    background-color: rgba(212, 165, 116, 0.1); /* Canvas-400 */
}

.pagination .page-item.active .page-link {
    background-color: var(--primary-color);
    color: white;
    border: none;
    box-shadow: 0 4px 6px rgba(212, 165, 116, 0.25); /* Canvas-400 */
}

.pagination .page-item .page-link:focus {
    box-shadow: none;
    outline: none;
}

.pagination .page-item.disabled .page-link {
    color: var(--grey-400);
    pointer-events: none;
}
/* END Pagination */

/* =============================================================================
   KEEP - Utility Classes (still used across app)
   ============================================================================= */
.text-primary {
    color: var(--primary-color) !important;
}

.bg-primary {
    background-color: var(--primary-color) !important;
}

/* Loading Indicators */
.spinner-border.text-primary {
    color: var(--primary-color) !important;
}
/* END Utility Classes */

/* =============================================================================
   KEEP - Media Queries (still functional)
   ============================================================================= */
@media (max-width: 767.98px) {
    /* Hide search text on mobile, show only icon */
    .search-form .btn .search-text {
        display: none;
    }

    /* Adjust padding for search button on mobile */
    .search-form .btn {
        padding: 0 1rem;
    }

    /* Remove margin after icon when text is hidden */
    .search-form .btn .fa-search {
        margin-right: 0 !important;
    }
    .book-cover-section {
        border-radius: 0.375rem 0.375rem 0 0;
        padding: 1.5rem;
    }

    .book-cover {
        max-height: 350px;
    }

    .hero-section {
        padding: 3rem 0;
    }
}

@media (min-width: 576px) and (max-width: 991.98px) {
    .col-sm-6.col-md-4.col-lg-3 {
        width: 50%;
    }
}
/* END Media Queries */

/* =============================================================================
   @deprecated - THEME TOGGLE HEADER - REPLACED
   Old theme toggle styling replaced with Tailwind button in layout.html:207-227
   ============================================================================= */
.theme-toggle-header {
    display: inline-flex;
    align-items: center;
    color: var(--dark-color);
    font-size: 1.125rem;
    transition: color 0.2s ease-in-out, background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.theme-toggle-header:hover {
    color: var(--primary-color);
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 0.375rem;
    padding: 0.25rem;
}

[data-theme="dark"] .theme-toggle-header:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--primary-color);
}

/* Remove leftover theme-toggle-item styles */
.theme-toggle-item {
    display: none;
}
/* END DEPRECATED THEME TOGGLE HEADER */

/* =============================================================================
   KEEP - Dark Theme Base
   ============================================================================= */
/* Dark Theme Overrides */
/* Variable definitions for dark theme are now centralized in variables.css */

/* body styles for dark theme are handled by general body rule + variables.css */

/* .navbar, .footer, .nav-link, .navbar-brand, .card, .card-title, .card-footer styles for dark theme
   are handled by general rules + variables.css.
   Specific overrides for .navbar-brand and .nav-link:hover/.active are below if needed. */

/* .search-form .form-control, .search-form .btn, .badge.bg-light,
   .hero-section h1, .hero-section p, h2, h3 dark theme styles
   are handled by general rules + variables.css.
   The .hero-section itself might need a specific text color if --text-color-on-accent isn't sufficient.
   The current rule for [data-theme="dark"] .hero-section { color: #E0E7FF; } is a specific override. */

[data-theme="dark"] .hero-section {
    /* Transparent so modern-hero gradient (via variables) shows, for seamless dark blending */
    background: transparent;
    border-radius: 0 !important;
    margin-bottom: 0 !important;
}

/* Dark Mode Styles */
[data-theme="dark"] {
    color-scheme: dark;
    /* Variable definitions for dark theme are now centralized in variables.css */
}

/* Dark mode styling for book cards and containers */
/* All styles use CSS variables - no !important declarations */

/* Text visibility in card headings and small text for dark mode */
[data-theme="dark"] .metadata-item .metadata-label,
[data-theme="dark"] .card-subtitle.text-muted,
[data-theme="dark"] .tab-content .text-muted,
[data-theme="dark"] .card .text-muted {
    color: var(--text-color-secondary);
}

/* Specific overrides for elements if needed, beyond what variables provide */
[data-theme="dark"] .other-editions-section .card-title {
    color: var(--text-color-primary);
}

[data-theme="dark"] .other-editions-section .list-unstyled {
    color: var(--text-color-secondary);
}

[data-theme="dark"] .btn-success {
    background-color: var(--success-color);
    color: white;
    border-color: var(--success-color);
}

[data-theme="dark"] .list-unstyled strong {
    color: var(--text-color-primary);
}

/* Fixes for elements that might have explicit light theme backgrounds or text colors */
[data-theme="dark"] .card-footer.bg-white,
[data-theme="dark"] .card .bg-white,
[data-theme="dark"] .search-header {
    background-color: var(--card-bg);
}

/* Footer uses dedicated footer background variable, not card-bg */
[data-theme="dark"] footer {
    background-color: var(--footer-background-color);
    color: var(--footer-text-color);
}

[data-theme="dark"] .text-decoration-none.text-dark,
[data-theme="dark"] .card-title a {
    color: var(--text-color-primary);
}

/* Form controls, dropdowns, and pagination should now be styled by their general rules using dark theme variables.
   Only keep specific [data-theme="dark"] rules if a distinct appearance is required beyond variable changes. */

/* Example: If pagination needs a very specific dark mode look not achievable with variables alone */
/* [data-theme="dark"] .pagination { ... } */


/* =============================================================================
   KEEP - Theme Toggle Button (still functional)
   ============================================================================= */
#theme-toggle {
    border-radius: 50%;
    width: 38px;
    height: 38px;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: middle;
    transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out, color 0.2s ease-in-out;
}

#theme-toggle i {
    font-size: 1rem;
}

/* Light Mode Hover Effect */
#theme-toggle:hover {
    background-color: var(--grey-200);
    box-shadow: 0 0 8px rgba(0,0,0,0.15);
    color: var(--primary-dark);
}

/* Dark Mode Hover Effect */
[data-theme="dark"] #theme-toggle:hover {
    background-color: var(--grey-100);
    box-shadow: 0 0 10px var(--primary-glow-color);
    color: var(--primary-color);
}

/* Make the theme toggle more visible on mobile in dark mode */
[data-theme="dark"] #theme-toggle {
    color: white; /* Light color for visibility */
    background-color: rgba(255, 255, 255, 0.15); /* Subtle light background */
    box-shadow: 0 0 5px rgba(255, 255, 255, 0.2); /* Subtle glow */
}

/* Ensure the theme toggle is large enough and has proper spacing on mobile */
.theme-toggle-header.d-lg-none {
    margin-right: 10px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
}
/* END Theme Toggle */

/* =============================================================================
   KEEP - Book Details Dark Mode Styles (not yet migrated)
   ============================================================================= */
/* Dark mode styling for "Other Editions" section in book details */
[data-theme="dark"] #bookDetailTabContent #editions .list-group {
    background-color: transparent;
    border: none;
}

[data-theme="dark"] #bookDetailTabContent #editions .list-group-item {
    background-color: var(--card-bg);
    color: var(--text-color-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] #bookDetailTabContent #editions .list-group-item.active {
    background-color: var(--brand-primary);
    color: var(--text-on-primary-bg);
    border-color: var(--brand-primary);
}

[data-theme="dark"] #bookDetailTabContent #editions .other-editions-section h3 {
    color: var(--text-color-primary);
}

[data-theme="dark"] #bookDetailTabContent #editions p,
[data-theme="dark"] #bookDetailTabContent #editions .metadata-label,
[data-theme="dark"] #bookDetailTabContent #editions small {
    color: var(--text-color-secondary);
}

/* Book Details Dark Mode - Maintained for book.html */

/* =============================================================================
   KEEP - Development Mode Indicators
   ============================================================================= */
.dev-source-indicator {
    opacity: 0.9;
    border-radius: 50%;
    color: white;
    line-height: 0;
}

.dev-source-GOOGLE_BOOKS { background-color: var(--danger-color); }
.dev-source-OPEN_LIBRARY { background-color: var(--info-color); }
.dev-source-LONGITOOD { background-color: var(--secondary-color); }
.dev-source-S3_CACHE { background-color: var(--success-color); }
.dev-source-LOCAL_CACHE { background-color: var(--warning-color); color: var(--dark-color); text-shadow: none;}
.dev-source-UNDEFINED { background-color: var(--grey-500); }
.dev-source-ANY { background-color: var(--grey-400); }
.dev-source-NONE { background-color: var(--grey-300); color: var(--dark-color); text-shadow: none;}
/* END Development Indicators */

/* =============================================================================
   KEEP - Normalized Book Covers (still functional)
   ============================================================================= */
.normalized-cover {
    height: auto !important;
    width: auto !important;
    max-height: 85% !important;
    max-width: 85% !important;
    object-fit: contain !important;
    transform: none !important;
    margin: auto !important;
    padding: 5px !important;
}

/* Specific grid view settings */
.book-cover-container .normalized-cover {
    max-height: 80% !important;
    max-width: 80% !important;
}

/* Specific list view settings */
.book-cover-wrapper .normalized-cover {
    max-height: 180px !important;
    object-fit: contain !important;
}

/* Special handling for high-resolution images */
.high-res-cover {
    transform: scale(0.88) !important;
    max-height: 85% !important;
}

[data-theme="dark"] .book-cover-section {
    background-color: transparent !important;
}
/* END Normalized Covers */

/* =============================================================================
   KEEP - Tab Styling (not yet migrated)
   ============================================================================= */
[data-theme="dark"] .nav-tabs {
    border-bottom-color: var(--border-color);
}

[data-theme="dark"] .nav-tabs .nav-link {
    color: var(--text-color-secondary);
}

[data-theme="dark"] .nav-tabs .nav-link.active {
    background-color: transparent;
    border-color: var(--border-color) var(--border-color) transparent;
    color: var(--primary-color);
}

[data-theme="dark"] .nav-tabs .nav-link:hover:not(.active) {
    border-color: var(--border-color) var(--border-color) var(--border-color);
    color: var(--text-color);
}

/* Book details headings, if general h5 and metadata-label variables are not sufficient */
[data-theme="dark"] .book-metadata .metadata-label,
[data-theme="dark"] .tab-content h5 {
    color: var(--text-color-secondary);
}
/* END Tab Styling */



/* The hero-section, search-form .btn, cards, placeholders, popular-tags
   should now mostly be styled correctly by the generic rules using dark theme variables.
   We only add specific overrides if the generic variable approach isn't sufficient
   or if a distinctly different style is wanted for dark mode beyond variable changes. */

/* Example: If badges need further specific dark mode tweaks not covered by their variables */
/* [data-theme="dark"] .badge.bg-light { ... } */

/* Ensure any text that should remain dark on a light background (or vice-versa) is handled.
   Most of these should be covered by the new text color variables. */

/* Clean up previous specific dark theme rules if they are now handled by the variables */
/* For example, if you had specific color settings for h2, h3, card-title etc. in dark mode,
   they should now inherit correctly from 'color: var(--text-color);'
   or use 'var(--text-color-secondary)' as appropriate. */

/* Remove or comment out old [data-theme="dark"] rules that are now covered by the new variable system.
   For example, lines like:
   [data-theme="dark"] body { background-color: #1F2937; color: #F9FAFB; }
   [data-theme="dark"] .card { background-color: #374151; border-color: #4B5563; }
   ...and so on, should be removed as these are handled by var(--background-color), var(--text-color), var(--card-bg) etc.
*/

/* End of file */


[data-theme="dark"] .hero-section {
    /* background: linear-gradient(135deg, var(--hero-gradient-start) 0%, var(--hero-gradient-end) 100%); /* OLD GRADIENT */
    background-color: var(--hero-bg-color); /* Solid dark background, as per inspiration */
}


/* "View All" button in dark mode - uses CSS variables */
[data-theme="dark"] .btn-view-all.btn-outlined {
    background-color: transparent;
    color: var(--link-color);
    border-color: transparent;
    padding-left: 0;
    padding-right: 0;
}

[data-theme="dark"] .btn-view-all.btn-outlined:hover {
    background-color: transparent;
    color: var(--link-hover-color);
    border-color: transparent;
    text-decoration: underline;
}

[data-theme="dark"] .search-form .form-control {
    color: var(--text-color-primary);
    background-color: var(--input-bg);
    border-color: var(--input-border-color);
}

[data-theme="dark"] .search-form .form-control::placeholder {
    color: var(--placeholder-text-color);
}

/* Dark mode card styling - uses CSS variables for consistency */
[data-theme="dark"] .card {
    background-color: var(--card-bg);
    border-color: var(--border-color);
    box-shadow: var(--card-shadow);
    transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
}

[data-theme="dark"] .card:hover {
    transform: translateY(-6px);
    box-shadow: var(--card-shadow-hover);
    border-color: var(--brand-primary);
}

/* Fix text colors using CSS variables */
[data-theme="dark"] .card .card-title,
[data-theme="dark"] .card .card-title a {
    color: var(--text-color-primary);
    font-weight: 600;
}

[data-theme="dark"] .card .card-text.small,
[data-theme="dark"] .card .card-text.small a,
[data-theme="dark"] .card .text-muted {
    color: var(--text-color-secondary);
}

/* Card footer using CSS variables */
[data-theme="dark"] .card-footer {
    background-color: var(--card-bg);
    border-top-color: var(--border-color);
}

/* Button styling using CSS variables */
[data-theme="dark"] .card-footer .btn {
    background-color: var(--button-primary-bg);
    color: var(--button-primary-text);
    border-color: var(--button-primary-bg);
    font-weight: 500;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    transition: all 0.2s ease;
}

[data-theme="dark"] .card-footer .btn:hover {
    background-color: var(--button-primary-hover-bg);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transform: translateY(-1px);
}

/* Card body backgrounds using CSS variables */
[data-theme="dark"] .card-body {
    background-color: var(--card-bg);
}

/* Book cover container background */
[data-theme="dark"] .book-cover-container {
    background-color: var(--card-bg);
}

/* Ratings badge with proper contrast */
[data-theme="dark"] .badge.bg-warning {
    background-color: var(--warning-color);
    color: var(--dark-color);
}


/* =============================================================================
   KEEP - Search/Book Details Dark Mode (not yet migrated)
   ============================================================================= */
/* Ensure search result text visibility in dark mode */
[data-theme="dark"] .search-results-container h2,
[data-theme="dark"] .search-results-container h3,
[data-theme="dark"] .search-results-container p {
    color: var(--text-color-primary);
}

/* Specific override for "Results for:" text */
[data-theme="dark"] .search-header {
    color: var(--text-color-primary);
}

/* Fix for "Results for" text in the search header */
[data-theme="dark"] .search-header .text-muted {
    color: var(--text-color-secondary);
}

/* Dark mode text color fixes for book details page */
[data-theme="dark"] .breadcrumb-item,
[data-theme="dark"] .breadcrumb-item a,
[data-theme="dark"] .breadcrumb-item.active {
    color: var(--text-color-secondary);
}

[data-theme="dark"] .book-details h1.card-title,
[data-theme="dark"] .book-details h5.card-subtitle,
[data-theme="dark"] .book-details .metadata-value,
[data-theme="dark"] .book-details .card-text,
[data-theme="dark"] .book-description,
[data-theme="dark"] .book-details-section h5,
[data-theme="dark"] .book-details .nav-tabs .nav-link,
[data-theme="dark"] .book-categories h5 {
    color: var(--text-color-primary);
}

[data-theme="dark"] .book-details .metadata-label,
[data-theme="dark"] .book-details .small.text-muted {
    color: var(--text-color-secondary);
}

[data-theme="dark"] .book-details .fw-bold {
    color: var(--text-color-secondary);
}

[data-theme="dark"] .nav-tabs .nav-link.active {
    color: var(--brand-primary);
    background-color: var(--grey-900);
    border-color: var(--grey-700);
    border-bottom-color: var(--grey-900);
}

/* Ensure tab content has proper backgrounds in dark mode */
[data-theme="dark"] .tab-content {
    background-color: transparent;
}

/* Ensure breadcrumb links have proper styling */
[data-theme="dark"] .breadcrumb-item a:hover {
    color: var(--link-hover-color);
}
/* END Search/Book Details Dark Mode */

/* =============================================================================
   KEEP - Mobile Responsive (still functional)
   ============================================================================= */
/* Mobile responsive active link styling */
@media (max-width: 991.98px) {
    .nav-link.active:after,
    [data-theme="light"] .modern-navbar .nav-link.active:after {
        bottom: 0;
        height: 2px;
        width: auto;
        left: 0;
        right: 0;
        display: inline-block;
    }

    .navbar-collapse .nav-link {
        padding: 0.75rem 1rem;
        display: inline-block;
    }

    /* Use flexbox to align child elements (e.g., links) within navigation items for mobile responsiveness */
    .nav-item {
        display: flex;
    }
}
/* END Mobile Responsive */

/* =============================================================================
   KEEP - Affiliate Buttons (still functional)
   ============================================================================= */
/* Custom Affiliate Button Styles */
.btn.btn-affiliate {
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
    margin-bottom: 0.5rem;
}
.btn.btn-affiliate:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

/* Uniform height & centering for affiliate buttons & dropdown */
.btn-affiliate {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    height: 2.5rem !important;
    padding: 0 1.25rem !important;
}

.btn.btn-barnesandnoble {
    background-color: #00563f !important;
    border-color: #00563f !important;
    color: #ffffff !important;
}
.btn.btn-barnesandnoble:hover {
    background-color: #00402f !important;
    border-color: #003526 !important;
}

.btn.btn-bookshop {
    background-color: #4C32C0 !important;
    border-color: #4C32C0 !important;
    color: #ffffff !important;
}
.btn.btn-bookshop:hover {
    background-color: #3c28a0 !important;
    border-color: #302080 !important;
}

.btn.btn-audible {
    background-color: #ff9900 !important;
    border-color: #ff9900 !important;
    color: #000000 !important;
}
.btn.btn-audible:hover {
    background-color: #e68a00 !important;
    border-color: #cc7a00 !important;
    color: #000000 !important;
}
/* End Custom Affiliate Button Styles */

/* Affiliate Dropdown Styles */
.affiliate-dropdown .dropdown-toggle {
    display: flex;
    align-items: center;
}
.affiliate-dropdown .dropdown-toggle::after {
    margin-left: .5rem;
}
.affiliate-dropdown .dropdown-menu {
    background-color: #fff;
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    border-radius: .5rem;
    transition: none;
    transform: none !important;
    margin-top: .25rem;
    -webkit-backdrop-filter: blur(8px);
    backdrop-filter: blur(8px);
}
.affiliate-dropdown .dropdown-item {
    padding: .5rem 1rem;
    transition: background-color 0.2s ease, color 0.2s ease;
}
.affiliate-dropdown .dropdown-item:hover {
    background-color: #f8f9fa;
}
/* Dark mode overrides for affiliate dropdown */
[data-theme="dark"] .affiliate-dropdown .dropdown-menu {
    background-color: #2d2d2d;
    border-color: rgba(255,255,255,0.1);
}
[data-theme="dark"] .affiliate-dropdown .dropdown-item:hover {
    background-color: rgba(255,255,255,0.1);
}

/* Improved Affiliate Dropdown Positioning and Width */
.affiliate-dropdown {
    position: relative;
    display: inline-block;
    overflow: visible;
}
.affiliate-dropdown .dropdown-menu {
    min-width: 200px !important;
    width: auto !important;
    max-width: 300px !important;
    left: 0 !important;
    right: auto !important;
    z-index: 1050 !important;
    -webkit-backdrop-filter: blur(8px);
    backdrop-filter: blur(8px);
    background-color: rgba(255,255,255,0.85);
    border: 1px solid rgba(0,0,0,0.1);
    border-radius: .5rem;
    white-space: nowrap;
}

/* Responsive sizing for dropdown on mobile */
@media (max-width: 767.98px) {
    .affiliate-dropdown .dropdown-menu {
        min-width: 180px !important;
        max-width: calc(100vw - 2rem) !important;
    }
}

/* Dark mode reinterpretation */
[data-theme="dark"] .affiliate-dropdown .dropdown-menu {
    background-color: rgba(20,20,30,0.85) !important;
    border-color: rgba(255,255,255,0.1) !important;
}

/* Consistent colors for dropdown items */
.affiliate-dropdown .dropdown-item {
    color: var(--text-color-primary) !important;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.affiliate-dropdown .dropdown-item:hover,
.affiliate-dropdown .dropdown-item:focus {
    background-color: #D4A574 !important; /* Canvas-400 */
    color: #ffffff !important;
}
.affiliate-dropdown .dropdown-item.active {
    background-color: #D4A574 !important;
    color: #ffffff !important;
}

/* Allow affiliate dropdown menu to overflow main book card */
.book-details > .card.shadow.border-0.mb-5 {
    overflow: visible !important;
}

/* Ensure tab content allows dropdown overflow */
.tab-content {
    overflow: visible !important;
}
/* END Affiliate Buttons & Dropdowns */
